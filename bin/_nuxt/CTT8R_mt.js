import{_ as F,r as u,e as D,c as r,o as a,a as t,F as N,y as z,t as i,n as v,g as x,d as _,f as I,q as V,b as O}from"#entry";import{e as A,i as T,g as E,h as H}from"./EuvIHkR0.js";import{s as J}from"./BzLCLO6P.js";const K={class:"px-4 py-6"},P={key:0,class:"text-gray-500 text-center py-6"},U={key:1,class:"space-y-4"},q={class:"text-lg"},G={class:"flex-1"},Q={class:"flex justify-between items-center mb-1"},W={class:"text-xs text-gray-400"},X={class:"text-gray-800 font-medium mb-1"},Y={key:0,class:"text-xs text-gray-500 space-y-1"},Z={key:0},tt={key:0},et={key:1},st={class:"whitespace-pre-wrap break-words bg-gray-50 p-2 rounded"},ot={key:2,class:"text-gray-400 text-center py-6"},rt={__name:"RecentActivity",setup(S){const h=u([]),d=u(!0);D(async()=>{d.value=!0,h.value=await A(),d.value=!1});function p(l){return new Date(l).toLocaleString()}const f=l=>{switch(l){case"info":return"text-blue-500 bg-blue-100";case"warning":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-500 bg-red-100";default:return"text-gray-500 bg-gray-100"}},c=l=>{switch(l){case"info":return"ℹ️";case"warning":return"⚠️";case"error":return"❌";default:return"🔔"}};return(l,n)=>(a(),r("div",K,[n[2]||(n[2]=t("h2",{class:"text-xl font-semibold text-gray-800 mb-4"},"Recent Activity",-1)),d.value?(a(),r("div",P," Loading recent activity... ")):h.value.length>0?(a(),r("div",U,[(a(!0),r(N,null,z(h.value,s=>(a(),r("div",{key:s.id,class:"flex items-start space-x-4 p-4 bg-white rounded-xl shadow hover:shadow-lg transition"},[t("div",{class:v(["flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full",f(s.level)])},[t("span",q,i(c(s.level)),1)],2),t("div",G,[t("div",Q,[t("span",{class:v(["font-medium capitalize",f(s.level)])},i(s.level),3),t("span",W,i(p(s.created_at)),1)]),t("p",X,i(s.message),1),s.entity_type||s.metadata?(a(),r("div",Y,[s.entity_type?(a(),r("div",Z,[n[0]||(n[0]=t("span",{class:"font-semibold"},"Entity:",-1)),_(" "+i(s.entity_type)+" ",1),s.entity_id?(a(),r("span",tt,"(#"+i(s.entity_id)+")",1)):x("",!0)])):x("",!0),s.metadata?(a(),r("div",et,[n[1]||(n[1]=t("span",{class:"font-semibold"},"Details:",-1)),t("pre",st,i(JSON.stringify(s.metadata,null,2)),1)])):x("",!0)])):x("",!0)])]))),128))])):(a(),r("p",ot," No recent activity found. "))]))}},at=F(rt,[["__scopeId","data-v-05d285de"]]),nt={class:"min-h-screen bg-white"},it={class:"bg-white border-b border-gray-200"},lt={class:"px-8 py-6"},dt={class:"flex items-center justify-between"},ct={class:"flex items-center space-x-3"},ut=["disabled"],ft={class:"px-8 py-8"},vt={key:0,class:"flex items-center justify-center py-20"},mt={key:1,class:"bg-white border border-red-200 rounded-lg p-6 mb-8"},gt={class:"flex items-start"},ht={class:"ml-4"},xt={class:"text-gray-600 mt-2"},pt={key:2},yt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},bt={class:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow"},_t={class:"flex items-center"},wt={class:"ml-4"},kt={class:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow"},Mt={class:"flex items-center"},Bt={class:"ml-4"},$t={class:"text-2xl font-bold text-blue-600"},Dt={class:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow"},At={class:"flex items-center"},St={class:"ml-4"},Ct={class:"text-2xl font-bold text-yellow-600"},Rt={class:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow"},jt={class:"flex items-center"},Lt={class:"ml-4"},Ft={class:"text-2xl font-bold text-gray-900"},Nt={class:"bg-white border border-gray-200 rounded-lg shadow-sm"},Ot={__name:"dashboard",setup(S){const h=I(),d=u(null),p=u([]),f=u("offline"),c=u(!1),l=u(null),n=u(!0),s=u(null),y=async()=>{try{c.value=!0,l.value=null;const[o,e,m]=await Promise.all([E().catch(()=>({total_backups:0,storage_used:0,last_backup:null})),A().catch(()=>[]),H().catch(()=>({status:"offline"}))]);d.value=o,p.value=e.activities||e||[],f.value=m.status||"offline"}catch(o){l.value=o.message,console.error("Failed to load dashboard data:",o)}finally{c.value=!1}},w=()=>{y()},k=()=>{s.value&&clearInterval(s.value),n.value&&(s.value=J(async()=>{!c.value&&document.visibilityState==="visible"&&await y()},3e4))},M=()=>{s.value&&(clearInterval(s.value),s.value=null)},C=()=>{n.value=!n.value,n.value?k():M()},R=o=>o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(1)+"K":o.toString(),j=o=>{if(o===0)return"0 B";const e=1024,m=["B","KB","MB","GB","TB","PB"],g=Math.floor(Math.log(o)/Math.log(e));return parseFloat((o/Math.pow(e,g)).toFixed(1))+" "+m[g]},L=o=>{if(!o)return"Never";const e=new Date,m=new Date(o),g=e-m,b=Math.floor(g/6e4),B=Math.floor(g/36e5),$=Math.floor(g/864e5);return b<1?"Just now":b<60?`${b}m ago`:B<24?`${B}h ago`:$<7?`${$}d ago`:m.toLocaleDateString()};return D(()=>{if(!T()){h.push("/auth/login");return}y(),k()}),V(()=>{M()}),(o,e)=>(a(),r("div",nt,[t("div",it,[t("div",lt,[t("div",dt,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Dashboard"),t("p",{class:"mt-2 text-gray-600"},"Monitor your backup system status and manage your data")],-1)),t("div",ct,[t("button",{onClick:w,disabled:c.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[(a(),r("svg",{class:v(["w-4 h-4 mr-2",{"animate-spin":c.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[0]||(e[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),_(" "+i(c.value?"Refreshing...":"Refresh"),1)],8,ut),t("button",{onClick:C,class:v(n.value?"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500":"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500")},[e[1]||(e[1]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),_(" "+i(n.value?"Auto-refresh ON":"Auto-refresh OFF"),1)],2)])])])]),t("main",ft,[c.value&&!d.value?(a(),r("div",vt,[...e[3]||(e[3]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),t("p",{class:"mt-6 text-lg text-gray-600 font-medium"},"Loading dashboard...")],-1)])])):l.value?(a(),r("div",mt,[t("div",gt,[e[5]||(e[5]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",ht,[e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-red-800"},"Error loading dashboard",-1)),t("p",xt,i(l.value),1),t("button",{onClick:w,class:"mt-4 inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Try Again ")])])])):(a(),r("div",pt,[t("div",yt,[t("div",bt,[t("div",_t,[t("div",{class:v(["p-3 rounded-lg",f.value==="online"?"bg-green-100":"bg-red-100"])},[(a(),r("svg",{class:v(["w-6 h-6",f.value==="online"?"text-green-600":"text-red-600"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2))],2),t("div",wt,[e[7]||(e[7]=t("p",{class:"text-sm font-medium text-gray-600"},"System Status",-1)),t("p",{class:v(["text-2xl font-bold",f.value==="online"?"text-green-600":"text-red-600"])},i(f.value==="online"?"Online":"Offline"),3)])])]),t("div",kt,[t("div",Mt,[e[9]||(e[9]=t("div",{class:"p-3 bg-blue-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),t("div",Bt,[e[8]||(e[8]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Backups",-1)),t("p",$t,i(R(d.value?.total_backups||0)),1)])])]),t("div",Dt,[t("div",At,[e[11]||(e[11]=t("div",{class:"p-3 bg-yellow-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})])],-1)),t("div",St,[e[10]||(e[10]=t("p",{class:"text-sm font-medium text-gray-600"},"Storage Used",-1)),t("p",Ct,i(j(d.value?.storage_used||0)),1)])])]),t("div",Rt,[t("div",jt,[e[13]||(e[13]=t("div",{class:"p-3 bg-gray-100 rounded-lg"},[t("svg",{class:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Lt,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-600"},"Last Backup",-1)),t("p",Ft,i(L(d.value?.last_backup)),1)])])])]),t("div",Nt,[O(at)])]))])]))}};export{Ot as default};
